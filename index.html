<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>× ×™×”×•×œ ××’×•×¨×™× â€“ ×”×™×œ×˜×•×Ÿ 192</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background: linear-gradient(135deg, #8b0000, #00008b);
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      min-height: 100vh;
      padding: 30px 16px;
    }
    h1 { font-size: 32px; margin-bottom: 4px; }
    h2 { font-size: 22px; margin: 16px 0 8px; }
    .subtitle { font-size: 14px; color: #ccc; margin-bottom: 16px; }
    .screen { display: none; }
    .screen.active { display: block; }
    input, select, textarea {
      display: block;
      margin: 8px auto;
      padding: 12px;
      width: 100%;
      max-width: 340px;
      border-radius: 10px;
      border: none;
      font-size: 15px;
      font-family: Arial;
      color: #111;
    }
    textarea { resize: vertical; }
    .btn {
      display: block;
      margin: 14px auto 0;
      padding: 13px 36px;
      background: #58a6ff;
      color: #000;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      width: 100%;
      max-width: 340px;
    }
    .btn-back {
      background: none;
      color: #aaa;
      font-size: 13px;
      padding: 8px;
      margin-top: 10px;
      width: auto;
      max-width: none;
      border: none;
      cursor: pointer;
      display: inline-block;
    }
    .choice-btns {
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .choice-btns .btn {
      width: 145px;
      padding: 16px 10px;
      font-size: 14px;
      line-height: 1.6;
    }
    .menu-btns {
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .menu-btns .btn {
      width: 150px;
      padding: 16px 10px;
      font-size: 14px;
      line-height: 1.6;
    }
    label {
      display: block;
      margin: 12px auto 2px;
      max-width: 340px;
      text-align: right;
      font-size: 14px;
      color: #ddd;
    }
    #room-buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      margin: 10px auto;
      max-width: 340px;
    }
    .room-btn {
      padding: 10px 0;
      border-radius: 8px;
      border: none;
      background: #444;
      color: white;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      width: 50px;
    }
    .room-btn.selected { background: #58a6ff; color: #000; }
    .rooms-hint {
      font-size: 13px;
      color: #ccc;
      margin: 8px auto;
      max-width: 340px;
    }
  </style>
</head>
<body>

  <h1>ğŸ  × ×™×”×•×œ ××’×•×¨×™×</h1>
  <p class="subtitle">×”×™×œ×˜×•×Ÿ 192</p>

  <!-- ××¡×š ×‘×—×™×¨×” -->
  <div id="screen-home" class="screen active">
    <h2>××™ ××ª×”?</h2>
    <div class="choice-btns">
      <button class="btn" onclick="showScreen('screen-commander')">ğŸ‘¨â€âœˆï¸<br>××¤×§×“ ×§×•×¨×¡</button>
      <button class="btn" onclick="showScreen('screen-admin-login')">ğŸ”‘<br>××—×¨××™ ××’×•×¨×™×</button>
    </div>
  </div>

  <!-- ××¡×š ×›× ×™×¡×” ××¤×§×“ -->
  <div id="screen-commander" class="screen">
    <h2>××¤×§×“ ×§×•×¨×¡ â€“ ×›× ×™×¡×”</h2>
    <label>×©× ××œ×:</label>
    <input type="text" id="cmd-name" placeholder="×”×›× ×¡ ×©× ××œ×">
    <label>××™××™×™×œ:</label>
    <input type="email" id="cmd-email" placeholder="example@gmail.com">
    <button class="btn" onclick="commanderLogin()">×›× ×™×¡×”</button>
    <br>
    <button class="btn-back" onclick="showScreen('screen-home')">â† ×—×–×•×¨</button>
  </div>

  <!-- ××¡×š ×›× ×™×¡×” ××—×¨××™ -->
  <div id="screen-admin-login" class="screen">
    <h2>××—×¨××™ ××’×•×¨×™× â€“ ×›× ×™×¡×”</h2>
    <label>×¡×™×¡××”:</label>
    <input type="password" id="admin-pass" placeholder="×”×›× ×¡ ×¡×™×¡××”">
    <button class="btn" onclick="adminLogin()">×›× ×™×¡×”</button>
    <br>
    <button class="btn-back" onclick="showScreen('screen-home')">â† ×—×–×•×¨</button>
  </div>

  <!-- ×ª×¤×¨×™×˜ ××¤×§×“ -->
  <div id="screen-menu" class="screen">
    <h2 id="menu-title"></h2>
    <div class="menu-btns">
      <button class="btn" onclick="showScreen('screen-request')">ğŸ›ï¸<br>×‘×§×©×ª ×—×“×¨×™×</button>
      <button class="btn" onclick="showScreen('screen-fault')">ğŸ”§<br>×¤×ª×™×—×ª ×ª×§×œ×”</button>
    </div>
    <br>
    <button class="btn-back" onclick="showScreen('screen-home')">â† ×™×¦×™××”</button>
  </div>

  <!-- ××¡×š ×‘×§×©×ª ×—×“×¨×™× -->
  <div id="screen-request" class="screen">
    <h2>ğŸ›ï¸ ×‘×§×©×ª ×—×“×¨×™×</h2>
    <label>××¡×¤×¨ ×§×•×¨×¡:</label>
    <input type="text" id="req-course" placeholder="×œ×“×•×’××”: 2024/3">
    <label>××¡×¤×¨ ×—×™×™×œ×™×:</label>
    <input type="number" id="req-soldiers" placeholder="×›××” ×—×™×™×œ×™×?" oninput="updateRooms(this.value)">
    <div id="rooms-area" style="display:none">
      <p class="rooms-hint" id="rooms-hint"></p>
      <div id="room-buttons"></div>
    </div>
    <label>×ª××¨×™×š ×›× ×™×¡×”:</label>
    <input type="date" id="req-date-in">
    <label>×ª××¨×™×š ×™×¦×™××”:</label>
    <input type="date" id="req-date-out">
    <label>×”×¢×¨×•×ª (×œ× ×—×•×‘×”):</label>
    <input type="text" id="req-notes" placeholder="×”×¢×¨×•×ª × ×•×¡×¤×•×ª...">
    <button class="btn" onclick="submitRequest()">ğŸ“¤ ×”×’×© ×‘×§×©×”</button>
    <br>
    <button class="btn-back" onclick="showScreen('screen-menu')">â† ×—×–×•×¨</button>
  </div>

  <!-- ××¡×š ×ª×§×œ×” -->
  <div id="screen-fault" class="screen">
    <h2>ğŸ”§ ×¤×ª×™×—×ª ×ª×§×œ×”</h2>
    <label>××™×§×•×:</label>
    <select id="fault-location" onchange="updateLocation(this.value)">
      <option value="">-- ×‘×—×¨ ××™×§×•× --</option>
      <option value="×©×™×¨×•×ª×™×">ğŸš» ×©×™×¨×•×ª×™×</option>
      <option value="××§×œ×—×•×ª">ğŸš¿ ××§×œ×—×•×ª</option>
      <option value="×ª×’×œ×—×•×ª">ğŸª’ ×ª×’×œ×—×•×ª</option>
      <option value="××¡×“×¨×•×Ÿ">ğŸšª ××¡×“×¨×•×Ÿ</option>
      <option value="×—×“×¨">ğŸ›ï¸ ×—×“×¨</option>
    </select>
    <div id="fault-room-field" style="display:none">
      <label>××¡×¤×¨ ×—×“×¨:</label>
      <input type="number" id="fault-room-num" placeholder="41-60" min="41" max="60">
    </div>
    <label>×¡×•×’ ×ª×§×œ×”:</label>
    <select id="fault-type">
      <option value="">-- ×‘×—×¨ ×¡×•×’ --</option>
      <option value="× ×–×™×œ×”">ğŸ’§ × ×–×™×œ×”</option>
      <option value="×ª×§×œ×ª ×—×©××œ">âš¡ ×ª×§×œ×ª ×—×©××œ</option>
      <option value="×ª×§×œ×ª ××™× ×¡×˜×œ×¦×™×”">ğŸ”© ×ª×§×œ×ª ××™× ×¡×˜×œ×¦×™×”</option>
      <option value="× ×–×§ ×œ×¨×›×•×©">ğŸªŸ × ×–×§ ×œ×¨×›×•×©</option>
      <option value="××—×¨">ğŸ“ ××—×¨</option>
    </select>
    <label>×ª×™××•×¨:</label>
    <textarea id="fault-desc" placeholder="×ª××¨ ××ª ×”×ª×§×œ×”..." rows="3"></textarea>
    <button class="btn" onclick="submitFault()">ğŸ“¤ ×©×œ×— ×ª×§×œ×”</button>
    <br>
    <button class="btn-back" onclick="showScreen('screen-menu')">â† ×—×–×•×¨</button>
  </div>

  <!-- ××¡×š ××—×¨××™ -->
  <div id="screen-admin" class="screen">
    <h2>×‘×¨×•×š ×”×‘×, ××—×¨××™ ××’×•×¨×™× ğŸ‘‹</h2>
    <p style="color:#ccc;font-size:14px;margin-top:8px;">×›××Ÿ ×ª×•×›×œ ×œ× ×”×œ ×‘×§×©×•×ª ×•×ª×§×œ×•×ª</p>
    <br>
    <button class="btn-back" onclick="showScreen('screen-home')">â† ×™×¦×™××”</button>
  </div>

  <script>
    var SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzLVK8WWQxUFkNG__M-xlXlCxzdUMOjNHG0tJoZjewxHWAl8Slvrn4GgDK5_6MytF27/exec";
    var userName = "";
    var userEmail = "";
    var selectedRooms = [];

    function showScreen(id) {
      document.querySelectorAll('.screen').forEach(function(el) {
        el.classList.remove('active');
      });
      document.getElementById(id).classList.add('active');
    }

    function commanderLogin() {
      var name = document.getElementById('cmd-name').value.trim();
      var email = document.getElementById('cmd-email').value.trim();
      if (!name || !email) {
        alert('× × ×œ××œ× ×©× ×•××™××™×™×œ!');
        return;
      }
      userName = name;
      userEmail = email;
      document.getElementById('menu-title').textContent = '×©×œ×•× ' + name + ' ğŸ‘‹';
      showScreen('screen-menu');
    }

    function adminLogin() {
      var pass = document.getElementById('admin-pass').value;
      if (pass !== 'Hilton192!') {
        alert('×¡×™×¡××” ×©×’×•×™×”!');
        return;
      }
      showScreen('screen-admin');
    }

    function updateRooms(val) {
      var soldiers = parseInt(val) || 0;
      var needed = Math.ceil(soldiers / 8);
      var area = document.getElementById('rooms-area');
      var hint = document.getElementById('rooms-hint');
      var btns = document.getElementById('room-buttons');
      selectedRooms = [];
      if (soldiers > 0) {
        area.style.display = 'block';
        hint.textContent = soldiers + ' ×—×™×™×œ×™× = ' + needed + ' ×—×“×¨×™×. ×‘×—×¨ ' + needed + ' ×—×“×¨×™×:';
        btns.innerHTML = '';
        var blocked = [51, 54];
        for (var i = 41; i <= 60; i++) {
          if (blocked.includes(i)) continue;
          var btn = document.createElement('button');
          btn.className = 'room-btn';
          btn.textContent = i;
          btn.onclick = (function(b, num, n) {
            return function() {
              if (b.classList.contains('selected')) {
                b.classList.remove('selected');
                selectedRooms = selectedRooms.filter(function(x) { return x !== num; });
              } else {
                if (selectedRooms.length >= n) {
                  alert('××¤×©×¨ ×œ×‘×—×•×¨ ×¨×§ ' + n + ' ×—×“×¨×™×!');
                  return;
                }
                b.classList.add('selected');
                selectedRooms.push(num);
              }
            };
          })(btn, i, needed);
          btns.appendChild(btn);
        }
      } else {
        area.style.display = 'none';
      }
    }

    function updateLocation(val) {
      document.getElementById('fault-room-field').style.display = val === '×—×“×¨' ? 'block' : 'none';
    }

    function submitRequest() {
      var course = document.getElementById('req-course').value.trim();
      var soldiers = document.getElementById('req-soldiers').value;
      var dateIn = document.getElementById('req-date-in').value;
      var dateOut = document.getElementById('req-date-out').value;
      var notes = document.getElementById('req-notes').value;
      var needed = Math.ceil(parseInt(soldiers) / 8);
      if (!course || !soldiers || !dateIn || !dateOut) {
        alert('× × ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª!');
        return;
      }
      if (selectedRooms.length !== needed) {
        alert('× × ×œ×‘×—×•×¨ ' + needed + ' ×—×“×¨×™×!');
        return;
      }
      fetch(SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        body: JSON.stringify({
          ×¡×•×’: '×‘×§×©×”',
          ×©×: userName,
          ××™××™×™×œ: userEmail,
          ×§×•×¨×¡: course,
          ×—×™×™×œ×™×: soldiers,
          ×›× ×™×¡×”: dateIn,
          ×™×¦×™××”: dateOut,
          ×—×“×¨×™×: selectedRooms.join(', '),
          ×”×¢×¨×•×ª: notes
        })
      }).then(function() {
        alert('×”×‘×§×©×” ×”×•×’×©×” ×‘×”×¦×œ×—×”! âœ…');
        selectedRooms = [];
        showScreen('screen-menu');
      }).catch(function() {
        alert('×©×’×™××” ×‘×—×™×‘×•×¨ ×œ×©×¨×ª');
      });
    }

    function submitFault() {
      var location = document.getElementById('fault-location').value;
      var type = document.getElementById('fault-type').value;
      var desc = document.getElementById('fault-desc').value.trim();
      var roomNum = document.getElementById('fault-room-num').value;
      if (!location || !type || !desc) {
        alert('× × ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª!');
        return;
      }
      var finalLocation = location === '×—×“×¨' ? '×—×“×¨ ' + roomNum : location;
      fetch(SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        body: JSON.stringify({
          ×¡×•×’: '×ª×§×œ×”',
          ×©×: userName,
          ××™××™×™×œ: userEmail,
          ××™×§×•×: finalLocation,
          ×¡×•×’×ª×§×œ×”: type,
          ×ª×™××•×¨: desc
        })
      }).then(function() {
        alert('×”×ª×§×œ×” × ×¤×ª×—×” ×‘×”×¦×œ×—×”! ğŸ”§');
        showScreen('screen-menu');
      }).catch(function() {
        alert('×©×’×™××” ×‘×—×™×‘×•×¨ ×œ×©×¨×ª');
      });
    }
  </script>
</body>
</html>
